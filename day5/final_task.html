<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <button id="btn" onclick="press()">Load Users</button><br><br>
    <input type="text" id="t1" placeholder="search"><br><br>
    <table border="1px" id="tb"></table>

    <script>
        let allUsers = [];

        function press() {
            let fetchAPI = async () => {
                const res = await fetch("https://jsonplaceholder.typicode.com/users");
                const data = await res.json();
                allUsers = data;
                displayTable(allUsers);
            };
            fetchAPI();
        }

        function displayTable(users) {
            let tab = document.getElementById("tb");
            tab.innerHTML = "";

            let headerRow = document.createElement("tr");
            let headers = ["Name", "Email", "City"];
            headers.forEach(text => {
                let th = document.createElement("th");
                th.textContent = text;
                headerRow.appendChild(th);
            });
            tab.appendChild(headerRow);

            users.forEach(user => {
                let row = document.createElement("tr");

                let nameCell = document.createElement("td");
                nameCell.textContent = user.name;

                let emailCell = document.createElement("td");
                emailCell.textContent = user.email;

                let cityCell = document.createElement("td");
                cityCell.textContent = user.address.city;

                row.appendChild(nameCell);
                row.appendChild(emailCell);
                row.appendChild(cityCell);

                tab.appendChild(row);
            });
        }

        document.getElementById("t1").addEventListener("input", function () {
    let query = this.value.toLowerCase();
    let tab = document.getElementById("tb");
    tab.innerHTML = "";

    // Recreate header row
    let headerRow = document.createElement("tr");
    let headers = ["Name", "Email", "City"];
    headers.forEach(text => {
        let th = document.createElement("th");
        th.textContent = text;
        headerRow.appendChild(th);
    });
    tab.appendChild(headerRow);

    if (!query) {
        displayTable(allUsers); // show full table if search is empty
        return;
    }

    // Filter and show full rows
    allUsers.forEach(user => {
        if (
            user.name.toLowerCase().includes(query) ||
            user.email.toLowerCase().includes(query) ||
            user.address.city.toLowerCase().includes(query)
        ) {
            let row = document.createElement("tr");

            let nameCell = document.createElement("td");
            nameCell.textContent = user.name;

            let emailCell = document.createElement("td");
            emailCell.textContent = user.email;

            let cityCell = document.createElement("td");
            cityCell.textContent = user.address.city;

            row.appendChild(nameCell);
            row.appendChild(emailCell);
            row.appendChild(cityCell);

            tab.appendChild(row);
        }
    });
});
    </script>
</body>
</html>